language: bash
services: docker

env:
  - VERSION=40 VARIANT=slim
  - VERSION=50 VARIANT=slim
  - VERSION=60 VARIANT=slim
  - VERSION=60 VARIANT=slim64
  - VERSION=70 VARIANT=slim
  - VERSION=70 VARIANT=slim64

before_script:
  - IMAGE="pharo:${VERSION}-${VARIANT}"

script:
  - (cd "$VERSION" && docker build -t "$IMAGE" "${VARIANT}")
  - bash ./test.sh "${VERSION}" "${IMAGE}"

after_script:
  - docker images
